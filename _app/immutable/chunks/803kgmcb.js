import{f as C,a as e,t as l}from"./CL3oEfVs.js";import"./BQwq4nga.js";import{s as n,c as B,n as t,r as y}from"./DmthGHIe.js";import{L as o}from"./pJ4098Nb.js";import{C as E}from"./CDbv3uqJ.js";const w="_testing-rust-cli-apps",g={title:"Testing Rust-based CLI applications using temporary directories",publishedAt:"2026-01-17",tags:["Rust","Terminal","Open Source"]},{title:D,publishedAt:I,tags:L}=g;var _=C("<article><p>Update: As a result of writing this post, I also contributed some more in depth examples back to the Rust CLI book.</p><p>While the Rust CLI book covers the <!>, it doesn't show the full capabilities of the crates <!>, <!> and <!>.</p><p>Once you get used to reading Rust docs like <!>, you can find almost everything that you need. However, using my fresh perspective on the Rust ecosystem, I think this is a good opportunity to make it even easier to get started writing Rust-based CLI apps.</p><p><strong>TODO: Update with actual example from the other repo</strong></p><!></article>");function R(f){var r=_(),c=n(B(r)),d=n(B(c));o(d,{href:"https://rust-cli.github.io/book/tutorial/testing.html",children:(s,p)=>{t();var a=l("basics of testing CLI apps");e(s,a)},$$slots:{default:!0}});var h=n(d,2);o(h,{href:"https://crates.io/crates/assert_cmd",children:(s,p)=>{t();var a=l("assert_cmd");e(s,a)},$$slots:{default:!0}});var F=n(h,2);o(F,{href:"https://crates.io/crates/assert_fs",children:(s,p)=>{t();var a=l("assert_fs");e(s,a)},$$slots:{default:!0}});var A=n(F,2);o(A,{href:"https://crates.io/crates/predicates",children:(s,p)=>{t();var a=l("predicates");e(s,a)},$$slots:{default:!0}}),t(),y(c);var i=n(c),u=n(B(i));o(u,{href:"https://docs.rs/assert_fs/latest/assert_fs/",children:(s,p)=>{t();var a=l("docs.rs/assert_fs");e(s,a)},$$slots:{default:!0}}),t(),y(i);var m=n(i,2);E(m,{codeHTML:`<pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">#[test]</span></span>
<span class="line"><span style="color:#C678DD">fn</span><span style="color:#61AFEF"> find_content_in_file_of_tmp_dir</span><span style="color:#ABB2BF">() -> </span><span style="color:#E5C07B">Result</span><span style="color:#ABB2BF">&#x3C;(), </span><span style="color:#E5C07B">Box</span><span style="color:#ABB2BF">&#x3C;</span><span style="color:#C678DD">dyn</span><span style="color:#E06C75"> std</span><span style="color:#ABB2BF">::</span><span style="color:#E06C75">error</span><span style="color:#ABB2BF">::</span><span style="color:#E5C07B">Error</span><span style="color:#ABB2BF">>> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // IDEA: create a temp dir</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    //</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // Simulate that the file was modified by another program</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // Assert that the file still contains the expected string</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    //</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // Simulate that the file was renamed by another program</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // Assert that the old file no longer exists, and stderr contains the error</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // Assert that the new file contains the expected string</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // This shows the usage of a TMP directory, which is automatically cleaned up after running the tests</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // In the book copy, encourage to explore the docs for the relevant crates to learn more advanced APIs that are available for testing</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    let</span><span style="color:#E06C75"> file</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> assert_fs</span><span style="color:#ABB2BF">::</span><span style="color:#E5C07B">NamedTempFile</span><span style="color:#ABB2BF">::</span><span style="color:#61AFEF">new</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"sample.txt"</span><span style="color:#ABB2BF">)?;</span></span>
<span class="line"><span style="color:#E06C75">    file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">write_str</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"A test</span><span style="color:#56B6C2">\\n</span><span style="color:#98C379">Actual content</span><span style="color:#56B6C2">\\n</span><span style="color:#98C379">More content</span><span style="color:#56B6C2">\\n</span><span style="color:#98C379">Another test"</span><span style="color:#ABB2BF">)?;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    let</span><span style="color:#C678DD"> mut</span><span style="color:#E06C75"> cmd</span><span style="color:#56B6C2"> =</span><span style="color:#61AFEF"> cargo_bin_cmd!</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"grrs"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E06C75">    cmd</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">arg</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"test"</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">arg</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">path</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E06C75">    cmd</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">assert</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">        .</span><span style="color:#61AFEF">success</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">        .</span><span style="color:#61AFEF">stdout</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">predicate</span><span style="color:#ABB2BF">::</span><span style="color:#E5C07B">str</span><span style="color:#ABB2BF">::</span><span style="color:#61AFEF">contains</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"A test</span><span style="color:#56B6C2">\\n</span><span style="color:#98C379">Another test"</span><span style="color:#ABB2BF">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">    Ok</span><span style="color:#ABB2BF">(())</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>`}),y(r),e(f,r)}export{R as default,g as frontmatter,w as slug};
