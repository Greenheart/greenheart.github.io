import{f as z,a as t,t as m}from"./Bp23vAW-.js";import{L as h}from"./DWwWilYT.js";import{s,c as r,n,r as c}from"./GZG48BUc.js";import{C as i}from"./Bu2iz0Bf.js";const A="improving-shell-startup-with-lazy-loading",b={title:"Improving Oh My Zsh Startup Time with Lazy Loading",publishedAt:"2023-03-23",tags:["DX","Code Snippet"]},{title:w,publishedAt:_,tags:$}=b;var B=z("<article><p>Using <!> is usually a great experience. However, adding heavy plugins (like <code>nvm</code>) to load at startup time can really hurt performance. Luckily there's a way to lazy load them.</p><h2>A Simple Solution</h2><!><ol><li>Add the nvm plugin to your <code>.zshrc</code> file.</li><li>Enable lazy loading for the <code>nvm</code> plugin.</li><li>Make sure you source Oh My Zsh at the end.</li></ol><p>This method reduced my shell startup time from <em>~1.5 s</em> to <em>~200 ms</em>. A <strong>huge</strong> improvement for a common action I perform many times daily.</p><p>However, I soon realized some of my projects had external dependencies that relied on commands like <code>node</code> and <code>npm</code> (and other package managers) to always be defined in the shell environment. This caused weird crashes, since lazy loading <code>nvm</code> means commands like <code>node</code> and <code>npm</code> only gets enabled when they first got used.</p><h2>Conditionally Lazy Loading for Specific Directories</h2><p>Adding an if statement to avoid lazy loading in specific directories:</p><!><h2>Add more commands that should load nvm</h2><p>In the <!> for <code>nvm</code> plugin, there are also features that can be useful. For example, this is how to make sure <code>npx</code> and <code>pnpx</code> work even in new terminals.</p><!><p>Hopefully this saves some time, allowing you move at the speed of thought ðŸ’­</p></article>");function L(u){var a=B(),e=r(a),f=s(r(e));h(f,{href:"https://ohmyz.sh/",children:(l,C)=>{n();var p=m("Oh My Zsh");t(l,p)},$$slots:{default:!0}}),n(3),c(e);var d=s(e,2);i(d,{codeHTML:`<pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic"># ~/.zshrc</span></span>
<span class="line"><span style="color:#E06C75">plugins</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">nvm</span><span style="color:#98C379"> git</span><span style="color:#ABB2BF">) </span><span style="color:#7F848E;font-style:italic"># 1</span></span>
<span class="line"><span style="color:#61AFEF">zstyle</span><span style="color:#98C379"> ':omz:plugins:nvm'</span><span style="color:#98C379"> lazy</span><span style="color:#98C379"> yes</span><span style="color:#7F848E;font-style:italic"> # 2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">source</span><span style="color:#E06C75"> $ZSH</span><span style="color:#98C379">/oh-my-zsh.sh</span><span style="color:#7F848E;font-style:italic"> # 3</span></span>
<span class="line"></span></code></pre>`});var y=s(d,6);i(y,{codeHTML:`<pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic"># ~/.zshrc</span></span>
<span class="line"><span style="color:#E06C75">plugins</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">nvm</span><span style="color:#98C379"> git</span><span style="color:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic"># This excludes any subdirectory of "/your-project/"</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"># =~ is used for RegExp matching.</span></span>
<span class="line"><span style="color:#C678DD">if</span><span style="color:#ABB2BF"> ! [[ </span><span style="color:#E06C75">$PWD</span><span style="color:#56B6C2"> =~</span><span style="color:#98C379"> "/your-project/"</span><span style="color:#ABB2BF"> ]]; </span><span style="color:#C678DD">then</span></span>
<span class="line"><span style="color:#61AFEF">  zstyle</span><span style="color:#98C379"> ':omz:plugins:nvm'</span><span style="color:#98C379"> lazy</span><span style="color:#98C379"> yes</span></span>
<span class="line"><span style="color:#C678DD">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">source</span><span style="color:#E06C75"> $ZSH</span><span style="color:#98C379">/oh-my-zsh.sh</span></span>
<span class="line"></span></code></pre>`});var o=s(y,2),g=s(r(o));h(g,{href:"https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/nvm",children:(l,C)=>{n();var p=m("documentation");t(l,p)},$$slots:{default:!0}}),n(7),c(o);var v=s(o);i(v,{codeHTML:`<pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">zstyle</span><span style="color:#98C379"> ':omz:plugins:nvm'</span><span style="color:#98C379"> lazy-cmd</span><span style="color:#98C379"> npx</span><span style="color:#98C379"> pnpx</span></span>
<span class="line"></span></code></pre>`}),n(),c(a),t(u,a)}export{L as default,b as frontmatter,A as slug};
