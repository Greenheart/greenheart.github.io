<!doctype html>
<html lang="en" class="dark">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/images/favicon.svg" type="image/svg+xml" />
        <link rel="icon" href="/images/favicon-32x32.png" type="image/png" />
        <link rel="icon" href="/favicon.ico" />
        <meta name="theme-color" content="#5ac75f" />
        <meta name="color-scheme" content="dark light" />
        <script>
            document.documentElement.classList.toggle(
                'dark',
                localStorage.theme === 'dark' ||
                    (!('theme' in localStorage) &&
                        window.matchMedia('(prefers-color-scheme: dark)')
                            .matches),
            )
        </script>
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/images/compass-icon-square.svg"
        />
        <link
            href="/feed.json"
            type="application/feed+json"
            rel="alternate"
            title="Blog feed (JSON)"
        />
        <link
            href="/feed.atom"
            type="application/atom+xml"
            rel="alternate"
            title="Blog feed (Atom)"
        />
        
		<link href="../_app/immutable/assets/0.DwPfpOdv.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.B7YN4TTR.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DoQ2O1cR.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DmthGHIe.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DJze5qmA.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.CLp1gXW2.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BczPc4Zd.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/tV8Fnljd.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Co4GkNEq.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/5qfvcbkh.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CL3oEfVs.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BsOUpAhI.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.ChOChhef.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/pJ4098Nb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/2zvAppLV.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CXUuUdFk.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BQwq4nga.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BGbMauXH.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D7Pvki5j.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C1kzzhOH.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/5.D63wTxhv.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dgr0Sfp8.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BBZ11N0l.js"><!--12qhfyh--><meta name="fediverse:creator" content="@Greenheart@fosstodon.org"/><!----><!--1i4ddgx--><!--[--><!--]--> <!--[--><meta name="robots" content="index,follow"/><!--]--> <!--[--><meta name="description" content="Experienced fullstack developer, curious about how tech, systems thinking and Doughnut design for business can be combined to create a positive impact."/><!--]--> <!--[--><link rel="canonical" href="http://sveltekit-prerender/blog/live-reloading-db-schema-with-drizzle-sqlite"/><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[--><!--[--><meta property="og:url" content="http://sveltekit-prerender/blog/live-reloading-db-schema-with-drizzle-sqlite"/><!--]--> <!--[--><meta property="og:type" content="website"/> <!--[!--><!--[!--><!--[!--><!--[!--><!--]--><!--]--><!--]--><!--]--><!--]--> <!--[--><meta property="og:title" content="Live Reloading Database Schemas with Drizzle and SQLite"/><!--]--> <!--[--><meta property="og:description" content="Experienced fullstack developer, curious about how tech, systems thinking and Doughnut design for business can be combined to create a positive impact."/><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--><!----><title>Live Reloading Database Schemas with Drizzle and SQLite · Samuel Plumppu - Sustainability Entrepreneur &amp; Fullstack Developer</title>
    </head>

    <body
        class="bg-honeydew dark:bg-evergreen"
        data-sveltekit-preload-data="hover"
    >
        <div id="svelte" style="display: contents"><!--[--><!--[--><!----><!----> <header class="xs:text-base 2xs:justify-between mx-auto flex max-w-6xl flex-1 flex-wrap justify-center gap-x-2 gap-y-4 p-4 text-sm svelte-12qhfyh"><a href="/" class="link"><!---->Samuel Plumppu<!----></a><!----> <nav class="xs:space-x-4 flex space-x-2"><a href="/subscribe" title="Subscribe (Atom / JSON)" aria-label="Subscribe (Atom / JSON)" class="link flex"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" class="size-4" viewBox="0 0 24 24" aria-hidden="true"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M4 11a9 9 0 0 1 9 9M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></g></svg><!----></a><!----> <!--[--><a href="/blog" class="link"><!---->Blog<!----></a><a href="/about" class="link"><!---->About<!----></a><a href="/talks" class="link"><!---->Talks<!----></a><!--]--> <button title="Toggle theme from dark to light" aria-label="Toggle theme from dark to light" class="cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" class="size-5" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10m0-1.5v-17a8.5 8.5 0 0 1 0 17"></path></svg></button><!----></nav></header> <div class="container mx-auto max-w-6xl p-4 pb-0"><!----><article class="prose prose-hr:border-yellow/60 sm:prose-lg lg:prose-xl prose-blockquote:text-current prose-strong:text-current prose-blockquote:bg-white dark:prose-blockquote:bg-carbon-black prose-blockquote:py-1 prose-blockquote:rounded-md prose-headings:text-current mx-auto mt-4 max-w-[75ch] text-base text-current marker:text-current"><h1>Live Reloading Database Schemas with Drizzle and SQLite</h1> <div class="flex flex-wrap items-center gap-x-2 gap-y-4 text-xs whitespace-nowrap sm:text-sm"><span class="2xs:w-min w-full">4 min read</span> <span class="2xs:block hidden self-center">~</span> <div class="flex flex-nowrap gap-1"><span>Published <time datetime="2025-12-03T00:00:00.000Z">3 Dec 2025</time></span> <span><!--[--><!--[-->· Updated <time datetime="2026-01-16T18:16:56.000Z">16 Jan 2026</time><!--]--><!--]--></span></div></div> <!--[--><div class="xs:text-sm flex flex-wrap items-center gap-2 text-xs leading-3 sm:text-base my-4"><!--[--><span class="bg-white dark:bg-carbon-black rounded-xs p-1 sm:p-2">TypeScript</span><span class="bg-white dark:bg-carbon-black rounded-xs p-1 sm:p-2">Drizzle</span><span class="bg-white dark:bg-carbon-black rounded-xs p-1 sm:p-2">SQLite</span><!--]--></div><!--]--><!----> <!----><article><p>During development, automatically reloading modified TypeScript code and restarting the app gives a significant productivity boost. This is very common for all kinds of frontend and backend projects.</p><p>But what if you could live reload and automatically migrate your local development database whenever you change your <a href="https://orm.drizzle.team/" class="link"><!---->Drizzle<!----></a><!----> schema?</p><p>This seemed a bit crazy at first, but it turns out this works quite well! Let's explore how.</p><hr/><h2>Prototyping database schemas with Drizzle</h2><p>When using Drizzle, you define your database schema in a <code>schema.ts</code> file. For local development, it's usually a good idea to use the command <code>drizzle-kit push</code> to automatically migrate the database and smoothly iterate on your schema.</p><p>The <code>push</code>-based workflow usually requires you either:</p><ol><li>Stop the dev server, run <code>drizzle-kit push</code> and then start the dev server again.</li><li>Or keep two terminals open to manually run the <code>drizzle-kit push</code> in one of them and then saving a file to trigger a dev server restart in the other.</li></ol><p>If you make several rapid schema changes, both these alternatives require manual interactions (and your attention) even for tiny updates. For larger schema changes you will almost always need to manually review the <code>push</code>-based migration. Alternatively, you could just reset the DB and insert new seeding data that has been updated to the latest schema.</p><h2>Solution: live reloading database schemas</h2><p>I've so far only confirmed this solution works with SQLite, but it could likely also work for other databases supported by Drizzle, like Postgres.</p><p>Also note that the following Drizzle versions were used, and there might be changes for this to work with the upcoming Drizzle <code>v1</code>:</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75">    "drizzle-orm"</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">"0.44.7"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">    "drizzle-kit"</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">"0.31.7"</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre><!----><!----><p>The core idea is pretty simple. Only in development, run a small script when the backend starts, performing the following actions:</p><ol><li>Run <code>drizzle-kit push</code> in a non-interactive child-process (without <code>stdio</code>) and capture the output. The non-interactive child process ensures that the CLI prompt (if any is shown) will be aborted, preventing accidental data loss.</li><li>Parse the output and determine if there any prompt about data loss.</li><li>If there were schema changes that cause data loss, abort the backend startup process with an error, and make it clear manual actions are required.</li><li>However, most small schema changes just work, and in those cases Drizzle automatically applies the schema changes and lets the backend start as normal.</li></ol><p>This is the most important part of the script, implementing what was described above:</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">// dev-db-check.ts</span></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> { </span><span style="color:#E06C75">execSync</span><span style="color:#ABB2BF"> } </span><span style="color:#C678DD">from</span><span style="color:#98C379"> 'node:child_process'</span></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> { </span><span style="color:#E06C75">styleText</span><span style="color:#ABB2BF"> } </span><span style="color:#C678DD">from</span><span style="color:#98C379"> 'node:util'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E5C07B">DEV</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'This module should only be imported during development'</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// `drizzle-kit push` validates the DB schema changes</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// and attempts to migrate your database.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// Schema changes without data loss are applied immediately.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// This effectively works like a "live reload" for your</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// DB schema, which is very useful during development.</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> dbCheckResult</span><span style="color:#56B6C2"> =</span><span style="color:#61AFEF"> execSync</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'npx drizzle-kit push'</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">toString</span><span style="color:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// However, abort with an error if data loss could happen</span></span>
<span class="line"><span style="color:#C678DD">if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">/warning</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">data loss</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">revert</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">abort/</span><span style="color:#C678DD">gi</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">test</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">dbCheckResult</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#C678DD">    const</span><span style="color:#E5C07B"> msg</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> `</span><span style="color:#56B6C2">\n</span><span style="color:#98C379">Schema changes with potential data loss detected. Please resolve manually:</span><span style="color:#56B6C2">\n</span><span style="color:#98C379">`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">    console</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#61AFEF">styleText</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">red</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">msg</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#E5C07B">    console</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">dbCheckResult</span><span style="color:#56B6C2"> +</span><span style="color:#98C379"> '</span><span style="color:#56B6C2">\n</span><span style="color:#98C379">'</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#E5C07B">    process</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">exit</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre><!----><!----><p>I chose to put this code in a separate module, to clearly distinguish it from the main code path during production.</p><p>You can explore the <a href="https://github.com/paccao/allerthsbageri.se/pull/141/files#diff-6eb830c2d4ca2deb49aa3df603d79a9f6341f4be13c21d39959b79384748c873" class="link"><!---->full code for live reloading database schemas<!----></a><!---->. The same <a href="https://github.com/paccao/allerthsbageri.se/pull/141" class="link"><!---->PR<!----></a><!----> also implements some related DX enhancements explained below:</p><h2>Improving the local development experience</h2><p>Now when the core feature of live reloading the DB schema is in place, we can add several related quality of life improvements too:</p><ol><li>Automatically validate the DB schema to ensure the database is in a good state before starting the app. This runs every time you (re)start the dev server, letting you focus on other problems than keeping your development database in sync with the latest Drizzle schema.</li><li>Simplify first-time local setup by automating the creation of a development DB and adding seeding data if it does not exist.</li><li>Automatically re-create the development DB and add seeding data if you have just removed or replaced the development database. Common when working when working with SQLite and renaming/removing databases used to test various states.</li></ol><h2>Closing thoughts</h2><p>I would only use this for local development where I host the DB locally and not with so called "serverless" database services.</p><p>Again, I've only tested this with SQLite, so if you try this method with another DB - <a href="https://fosstodon.org/@Greenheart" class="link"><!---->let me know<!----></a><!----> how it works!</p><p>And if you have important data in your development database - please make sure you have backups before using scripts like this to automatically modify your database.</p><p>With that said, I hope this will make it easier to experiment and iterate on your database schema just like it did for me!</p></article><!----></article> <section class="dark:bg-carbon-black mx-auto mt-12 max-w-lg space-y-4 rounded-md bg-white p-4 text-center shadow-lg lg:text-lg"><h2 class="xs:text-2xl text-xl leading-none font-black tracking-tight md:text-3xl">Thank you for reading!</h2> <p><a href="https://fosstodon.org/@Greenheart" class="link compact"><!---->Let me know<!----></a><!----> if you have any questions
        or comments.</p> <p><span class="inline-flex flex-wrap items-center justify-center gap-1"><a href="/subscribe" class="link inline-flex items-center gap-1 compact"><img src="/images/feed.svg" alt="RSS/Atom feed icon" class="size-5"/>Subscribe<!----></a><!----> with your feed reader: <span class="inline-flex flex-nowrap items-center gap-0.5"><a href="/feed.atom" class="link self-center compact"><!---->Atom<!----></a><!---->/<a href="/feed.json" class="link self-center compact"><!---->JSON<!----></a><!----></span></span></p><!----> <p><a href="/blog" class="link compact"><!---->Read 15 more posts<!----></a><!----> or <a href="/" class="link compact"><!---->learn more<!----></a><!----> about me.</p></section> <nav class="mx-auto grid max-w-5xl gap-8 pt-8 sm:grid-cols-2 sm:gap-4 lg:gap-8"><!--[--><a href="/blog/keystatic-sveltekit-markdoc" class="dark:bg-carbon-black group flex flex-col gap-4 rounded-md bg-white p-4 shadow-md transition-all duration-300 hover:shadow-xl"><span class="flex items-center gap-2 text-xs font-bold tracking-wide uppercase"><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" class="size-5 shrink-0"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 18l-6-6l6-6"></path></svg><!----> Previous</span> <span class="group-hover:decoration-moss underline-offset-3 group-hover:underline">Integrate Keystatic CMS with SvelteKit to Render Markdoc Content with Interactive Svelte Components</span></a><!--]--> <!--[!--><div class="hidden sm:block"></div><!--]--></nav><!----><!----><!----></div> <footer class="container mx-auto max-w-6xl px-4 pb-8 text-center"><hr class="border-yellow mx-auto my-16 max-w-sm"/> <h2 class="xs:text-2xl mb-6 text-xl leading-none font-black tracking-tight text-balance sm:text-3xl lg:text-4xl">Let's co-create a sustainable future!</h2> <a href="#" class="bg-moss inline-flex transform-gpu justify-center justify-self-center rounded-md px-8 py-3 font-black text-black shadow-lg duration-150 ease-out hover:scale-105 hover:shadow-xl "><span class="whitespace-nowrap">Email me</span></a><!----> <p class="mt-8">© 2015 - 2026 Samuel Plumppu</p> <div class="flex flex-wrap items-center justify-center space-x-8 dark:invert my-8"><a href="https://matrix.to/#/@Greenheart:matrix.org" target="_blank" rel="noopener noreferrer" aria-label="Message me securely with the Matrix protocol"><img src="/images/matrix-logo.svg" alt="Matrix.org logo" class="h-6"/></a> <a href="https://github.com/Greenheart" target="_blank" rel="noopener noreferrer" aria-label="See my libre software at GitHub"><img src="/images/github.svg" alt="GitHub" class="aspect-square h-6"/></a> <a href="https://fosstodon.org/@Greenheart" target="_blank" rel="me noopener noreferrer" aria-label="Follow me on Mastodon"><img src="/images/mastodon-logo.svg" alt="Mastodon" class="aspect-square h-6"/></a> <a href="https://linkedin.com/in/samuelplumppu" target="_blank" rel="noopener noreferrer" aria-label="Connect with me on LinkedIn"><img src="/images/linkedin.svg" alt="LinkedIn" class="aspect-square h-6"/></a></div><!----> <p><span class="inline-flex flex-wrap items-center justify-center gap-1"><a href="/subscribe" class="link inline-flex items-center gap-1 compact"><img src="/images/feed.svg" alt="RSS/Atom feed icon" class="size-5"/>Subscribe<!----></a><!----> with your feed reader: <span class="inline-flex flex-nowrap items-center gap-0.5"><a href="/feed.atom" class="link self-center compact"><!---->Atom<!----></a><!---->/<a href="/feed.json" class="link self-center compact"><!---->JSON<!----></a><!----></span></span></p><!----></footer><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_5s9jbz = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.B7YN4TTR.js"),
						import("../_app/immutable/entry/app.CLp1gXW2.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
    </body>
</html>
