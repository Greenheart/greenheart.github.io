<!doctype html>
<html lang="en" class="dark">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/images/favicon.svg" type="image/svg+xml" />
        <link rel="icon" href="/images/favicon-32x32.png" type="image/png" />
        <link rel="icon" href="/favicon.ico" />
        <meta name="theme-color" content="#5ac75f" />
        <meta name="color-scheme" content="dark light" />
        <script>
            document.documentElement.classList.toggle(
                'dark',
                localStorage.theme === 'dark' ||
                    (!('theme' in localStorage) &&
                        window.matchMedia('(prefers-color-scheme: dark)')
                            .matches),
            )
        </script>
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/images/compass-icon-square.svg"
        />
        <link
            href="/feed.json"
            type="application/feed+json"
            rel="alternate"
            title="Blog feed (JSON)"
        />
        <link
            href="/feed.atom"
            type="application/atom+xml"
            rel="alternate"
            title="Blog feed (Atom)"
        />
        
		<link href="../_app/immutable/assets/0.C3WNfWVC.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.HC0HjJFi.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BGmgx0Lh.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DmthGHIe.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DJze5qmA.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.CEKS7GuO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BczPc4Zd.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/tV8Fnljd.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Co4GkNEq.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/5qfvcbkh.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CL3oEfVs.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BsOUpAhI.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.BveLPAUf.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/pJ4098Nb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/2zvAppLV.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CXUuUdFk.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BQwq4nga.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BGbMauXH.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D7Pvki5j.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C1kzzhOH.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/5.DFYxUyM6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D12VPqWq.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BBZ11N0l.js"><!--12qhfyh--><meta name="fediverse:creator" content="@Greenheart@fosstodon.org"/><!----><!--1i4ddgx--><!--[--><!--]--> <!--[--><meta name="robots" content="index,follow"/><!--]--> <!--[--><meta name="description" content="Experienced fullstack developer, curious about how tech, systems thinking and Doughnut design for business can be combined to create a positive impact."/><!--]--> <!--[--><link rel="canonical" href="http://sveltekit-prerender/blog/generate-password-in-browser-web-crypto-api"/><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[--><!--[--><meta property="og:url" content="http://sveltekit-prerender/blog/generate-password-in-browser-web-crypto-api"/><!--]--> <!--[--><meta property="og:type" content="website"/> <!--[!--><!--[!--><!--[!--><!--[!--><!--]--><!--]--><!--]--><!--]--><!--]--> <!--[--><meta property="og:title" content="Use the Web Crypto API to Generate a Cryptographically Secure Password in the Browser and Node.js"/><!--]--> <!--[--><meta property="og:description" content="Experienced fullstack developer, curious about how tech, systems thinking and Doughnut design for business can be combined to create a positive impact."/><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--><!----><title>Use the Web Crypto API to Generate a Cryptographically Secure Password in the Browser and Node.js · Samuel Plumppu - Sustainability Entrepreneur &amp; Fullstack Developer</title>
    </head>

    <body
        class="bg-honeydew dark:bg-evergreen"
        data-sveltekit-preload-data="hover"
    >
        <div id="svelte" style="display: contents"><!--[--><!--[--><!----><!----> <header class="xs:text-base 2xs:justify-between mx-auto flex max-w-6xl flex-1 flex-wrap justify-center gap-x-2 gap-y-4 p-4 text-sm svelte-12qhfyh"><a href="/" class="link"><!---->Samuel Plumppu<!----></a><!----> <nav class="xs:space-x-4 flex space-x-2"><a href="/subscribe" title="Subscribe (Atom / JSON)" aria-label="Subscribe (Atom / JSON)" class="link flex"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" class="size-4" viewBox="0 0 24 24" aria-hidden="true"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M4 11a9 9 0 0 1 9 9M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></g></svg><!----></a><!----> <!--[--><a href="/blog" class="link"><!---->Blog<!----></a><a href="/about" class="link"><!---->About<!----></a><a href="/talks" class="link"><!---->Talks<!----></a><!--]--> <button title="Toggle theme from dark to light" aria-label="Toggle theme from dark to light" class="cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" class="size-5" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10m0-1.5v-17a8.5 8.5 0 0 1 0 17"></path></svg></button><!----></nav></header> <div class="container mx-auto max-w-6xl p-4 pb-0"><!----><article class="prose prose-hr:border-yellow/60 sm:prose-lg lg:prose-xl prose-blockquote:text-current prose-strong:text-current prose-blockquote:bg-white dark:prose-blockquote:bg-carbon-black prose-blockquote:py-1 prose-blockquote:rounded-md prose-headings:text-current mx-auto mt-4 max-w-[75ch] text-base text-current marker:text-current"><h1>Use the Web Crypto API to Generate a Cryptographically Secure Password in the Browser and Node.js</h1> <div class="flex flex-wrap gap-1 text-sm whitespace-nowrap sm:text-base"><span>Published <time datetime="2021-07-28T00:00:00.000Z">28 Jul 2021</time></span> <span><!--[--><!--[-->· Updated <time datetime="2025-12-16T22:40:59.000Z">16 Dec 2025</time><!--]--><!--]--></span></div> <!--[--><div class="xs:text-sm flex flex-wrap items-center gap-2 text-xs leading-3 sm:text-base my-4"><!--[--><span class="bg-white dark:bg-carbon-black rounded-xs p-1 sm:p-2">JavaScript</span><span class="bg-white dark:bg-carbon-black rounded-xs p-1 sm:p-2">Web Crypto API</span><span class="bg-white dark:bg-carbon-black rounded-xs p-1 sm:p-2">Node.js</span><!--]--></div><!--]--><!----> <!----><article><p>Strong, cryptographically safe passwords are an essential foundation to live a secure digital life. With an open source password manager like <a href="https://bitwarden.com/" class="link"><!---->Bitwarden<!----></a><!---->, it's never been more accessible to generate unique, strong passwords for every online account, and then storing them in your password vault.</p><p>But what if you want to add password generation directly to your web app? That's recently been getting much more accessible as well thanks to the standard <a href="https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto" class="link"><!---->Web Crypto API<!----></a><!---->.</p><h2>Use the Web Crypto API in Any Environment</h2><p>In order to make the generator work in both browsers and Node.js, we need an abstraction. This ensures we can use the same Web Crypto API no matter where the generator is used.</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">// crypto.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * Get a reference to the Web Crypto API in any modern JS environment</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@returns</span><span style="color:#7F848E;font-style:italic"> An object implementing the Web Crypto API.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">async</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> loadCrypto</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span></span>
<span class="line"><span style="color:#ABB2BF">        (</span><span style="color:#C678DD">typeof</span><span style="color:#E06C75"> window</span><span style="color:#56B6C2"> !==</span><span style="color:#98C379"> 'undefined'</span><span style="color:#56B6C2"> &#x26;&#x26;</span><span style="color:#E5C07B"> window</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">crypto</span><span style="color:#ABB2BF">) </span><span style="color:#56B6C2">||</span></span>
<span class="line"><span style="color:#ABB2BF">        (</span><span style="color:#E06C75">globalThis</span><span style="color:#56B6C2"> &#x26;&#x26;</span><span style="color:#E5C07B"> globalThis</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">crypto</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">    ) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // Running in browsers released after 2017, and other</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // runtimes with `globalThis` like Deno or CloudFlare Workers</span></span>
<span class="line"><span style="color:#C678DD">        const</span><span style="color:#E5C07B"> crypto</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> window</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">crypto</span><span style="color:#56B6C2"> ||</span><span style="color:#E5C07B"> globalThis</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">crypto</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> Promise</span><span style="color:#ABB2BF">((</span><span style="color:#E06C75;font-style:italic">resolve</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=></span><span style="color:#61AFEF"> resolve</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">crypto</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // Running in Node.js >= 15</span></span>
<span class="line"><span style="color:#C678DD">        const</span><span style="color:#E5C07B"> nodeCrypto</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> await</span><span style="color:#61AFEF"> import</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'crypto'</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> nodeCrypto</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">webcrypto</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> crypto</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> await</span><span style="color:#61AFEF"> loadCrypto</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> default</span><span style="color:#E06C75"> crypto</span></span>
<span class="line"></span></code></pre><!----><!----><h2>Creating a Password by Selecting Random Characters</h2><p>The way our generator is going to work is by creating an array of a given length (matching the password length), and then filling it with random characters.</p><p>First, we'll import the crypto abstraction and define the character set we want to use.</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">// generate-password.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#E06C75"> crypto</span><span style="color:#C678DD"> from</span><span style="color:#98C379"> './crypto'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> digits</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> '0123456789'</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> upper</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> lower</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> upper</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">toLowerCase</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> CHAR_SET</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> digits</span><span style="color:#56B6C2"> +</span><span style="color:#E06C75"> upper</span><span style="color:#56B6C2"> +</span><span style="color:#E06C75"> lower</span></span>
<span class="line"></span></code></pre><!----><!----><p>Using <code>Array.from()</code>, we can provide a <code>Array.prototype.map()</code> callback to add the random characters directly while the array is created. Then, we just have to join the password into a string and we're done - except for the details of <code>getRandomCharacter()</code> which we'll cover soon.</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * Generate a random password of a given length.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {number}</span><span style="color:#E06C75;font-style:italic"> length</span><span style="color:#7F848E;font-style:italic"> The password length.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {string}</span><span style="color:#E06C75;font-style:italic"> characters</span><span style="color:#7F848E;font-style:italic"> The set of characters to pick from.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@returns</span><span style="color:#7F848E;font-style:italic"> A random password.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> generatePassword</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">length</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 80</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">characters</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> CHAR_SET</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> Array</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">from</span><span style="color:#ABB2BF">({ </span><span style="color:#E06C75">length</span><span style="color:#ABB2BF"> }, (</span><span style="color:#E06C75;font-style:italic">_</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=></span></span>
<span class="line"><span style="color:#61AFEF">        getRandomCharacter</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">characters</span><span style="color:#ABB2BF">),</span></span>
<span class="line"><span style="color:#ABB2BF">    ).</span><span style="color:#61AFEF">join</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">''</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre><!----><!----><h2>Cryptographically Secure Random Number Generation</h2><p>Let's implement <code>getRandomCharacter()</code>. To ensure the characters are randomized in a cryptographically safe way, we use <code>crypto.getRandomValues()</code>. This is <em>strongly</em> recommended instead of using <code>Math.random()</code> which may seem simpler, but is not secure enough for our needs.</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * Get a random character from a given set of characters.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {string}</span><span style="color:#E06C75;font-style:italic"> characters</span><span style="color:#7F848E;font-style:italic"> The set of characters to pick from.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@returns</span><span style="color:#7F848E;font-style:italic"> A random character.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">function</span><span style="color:#61AFEF"> getRandomCharacter</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">characters</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    const</span><span style="color:#E5C07B"> randomNumber</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> crypto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getRandomValues</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Uint8Array</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">))[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">]</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E06C75"> characters</span><span style="color:#ABB2BF">[</span><span style="color:#E06C75">randomNumber</span><span style="color:#56B6C2"> %</span><span style="color:#E5C07B"> characters</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">length</span><span style="color:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre><!----><!----><p>To explain <code>getRandomCharacter()</code>, let's start by thinking about the character set again. Since our character set has less than 256 characters (8 bytes), we can pass an <code>Uint8Array</code> to <code>crypto.getRandomValues()</code>, to fill it with random numbers. In our case, this will be a single number between 0-255 since we created an <code>Uint8Array</code> with <code>1</code> byte. We'll retrieve the <code>randomNumber</code> and can now use this to calculate the random index from where to pick the next character.</p><p>Since our character set contains less than 256 characters, we need to ensure the random number isn't out of range to avoid crashes. This can be done using <code>%</code> - the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Remainder" class="link"><!---->Remainder operator<!----></a><!---->, which allows us to use a random number potentially much larger than our character set length, and always get a value within our desired range.</p><p>However, this method has a severe security issue - it will cause the first characters in our set to appear more often, greatly reducing the password security. This is caused by the fact that the result when using the remainder operator will restart from 0 once <code>randomNumber</code> has reached another multiple of the character set length. <code>39 % 40</code> yields <code>39</code> and <code>40 % 40</code> yields <code>0</code>, meaning we'll get the last character and then the first character again. This repeats for larger multiples such as 80 and so on, until the final iteration where we've reached the final multiple before 255. Then the remaining indices will add additional probability to pick the first characters with the lowest indices.</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> characters</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> '...'</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> characterLength</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 40</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> randomNumber1</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 39</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> randomNumber2</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 40</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> index1</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> randomNumber1</span><span style="color:#56B6C2"> %</span><span style="color:#E06C75"> characterLength</span><span style="color:#7F848E;font-style:italic"> // 39 % 40 = 39</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> index2</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> randomNumber2</span><span style="color:#56B6C2"> %</span><span style="color:#E06C75"> characterLength</span><span style="color:#7F848E;font-style:italic"> // 40 % 40 = 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> first</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> characters</span><span style="color:#ABB2BF">[</span><span style="color:#E06C75">index1</span><span style="color:#ABB2BF">] </span><span style="color:#7F848E;font-style:italic">// Returns the last character</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> second</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> characters</span><span style="color:#ABB2BF">[</span><span style="color:#E06C75">index2</span><span style="color:#ABB2BF">] </span><span style="color:#7F848E;font-style:italic">// Returns the first character!</span></span>
<span class="line"></span></code></pre><!----><!----><h2>Ensure Random Characters Have Equal Distribution</h2><p>To work around the issue caused by the remainder operator, we can only allow random numbers that are smaller than the maximum multiple of the character set length that is in turn smaller than 255 (the maximum possible value for our random number when using an <code>Uint8Array</code>).</p><p>To calculate the maximum value, we can use the following expression:</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> max</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 256</span><span style="color:#56B6C2"> -</span><span style="color:#ABB2BF"> (</span><span style="color:#D19A66">256</span><span style="color:#56B6C2"> %</span><span style="color:#E5C07B"> characters</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">length</span><span style="color:#ABB2BF">)</span></span>
<span class="line"></span></code></pre><!----><!----><p>To give an example, this means that a character set length of 60 would yield the maximum random number 240, since 240 is the largest number that is both less than 256 and evenly divisible by 60.</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> max</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 256</span><span style="color:#56B6C2"> -</span><span style="color:#ABB2BF"> (</span><span style="color:#D19A66">256</span><span style="color:#56B6C2"> %</span><span style="color:#D19A66"> 60</span><span style="color:#ABB2BF">) </span><span style="color:#7F848E;font-style:italic">// 240</span></span>
<span class="line"></span></code></pre><!----><!----><p>Getting back to implementing <code>getRandomCharacter()</code>, the next step would be to ensure that we regenerate <code>randomNumber</code> as long as it's larger than our maximum allowed value. In the final version of <code>getRandomCharacter()</code>, we'll use a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/do...while" class="link"><!---->do...while<!----></a><!----> loop to achieve this:</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * Get a random character from a given set of characters.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {string}</span><span style="color:#E06C75;font-style:italic"> characters</span><span style="color:#7F848E;font-style:italic"> The set of characters to pick from.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@returns</span><span style="color:#7F848E;font-style:italic"> A random character.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">function</span><span style="color:#61AFEF"> getRandomCharacter</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">characters</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    let</span><span style="color:#E06C75"> randomNumber</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * Due to the repeating nature of results from the remainder</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * operator, we potentially need to regenerate the random number</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * several times. This is required to ensure all characters have</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * the same probability to get picked. Otherwise, the first</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * characters would appear more often, resulting in a weaker</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * password security.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    do</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">        randomNumber</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> crypto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getRandomValues</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Uint8Array</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">))[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">while</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">randomNumber</span><span style="color:#56B6C2"> >=</span><span style="color:#D19A66"> 256</span><span style="color:#56B6C2"> -</span><span style="color:#ABB2BF"> (</span><span style="color:#D19A66">256</span><span style="color:#56B6C2"> %</span><span style="color:#E5C07B"> characters</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">length</span><span style="color:#ABB2BF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E06C75"> characters</span><span style="color:#ABB2BF">[</span><span style="color:#E06C75">randomNumber</span><span style="color:#56B6C2"> %</span><span style="color:#E5C07B"> characters</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">length</span><span style="color:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre><!----><!----><h2>The Finished Password Generator</h2><p>Here's how the generator looks when all pieces come together!</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">// generate-password.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#E06C75"> crypto</span><span style="color:#C678DD"> from</span><span style="color:#98C379"> './crypto'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> digits</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> '0123456789'</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> upper</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> lower</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> upper</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">toLowerCase</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> CHAR_SET</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> digits</span><span style="color:#56B6C2"> +</span><span style="color:#E06C75"> upper</span><span style="color:#56B6C2"> +</span><span style="color:#E06C75"> lower</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * Generate a random password of a given length.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {number}</span><span style="color:#E06C75;font-style:italic"> length</span><span style="color:#7F848E;font-style:italic"> The password length.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {string}</span><span style="color:#E06C75;font-style:italic"> characters</span><span style="color:#7F848E;font-style:italic"> The set of characters to pick from.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@returns</span><span style="color:#7F848E;font-style:italic"> A random password.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> generatePassword</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">length</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 80</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">characters</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> CHAR_SET</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> Array</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">from</span><span style="color:#ABB2BF">({ </span><span style="color:#E06C75">length</span><span style="color:#ABB2BF"> }, (</span><span style="color:#E06C75;font-style:italic">_</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=></span></span>
<span class="line"><span style="color:#61AFEF">        getRandomCharacter</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">characters</span><span style="color:#ABB2BF">),</span></span>
<span class="line"><span style="color:#ABB2BF">    ).</span><span style="color:#61AFEF">join</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">''</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * Get a random character from a given set of characters.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {string}</span><span style="color:#E06C75;font-style:italic"> characters</span><span style="color:#7F848E;font-style:italic"> The set of characters to pick from.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@returns</span><span style="color:#7F848E;font-style:italic"> A random character.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">function</span><span style="color:#61AFEF"> getRandomCharacter</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">characters</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    let</span><span style="color:#E06C75"> randomNumber</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * Due to the repeating nature of results from the remainder</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * operator, we potentially need to regenerate the random number</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * several times. This is required to ensure all characters have</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * the same probability to get picked. Otherwise, the first</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * characters would appear more often, resulting in a weaker</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * password security.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    do</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">        randomNumber</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> crypto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getRandomValues</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Uint8Array</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">))[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">while</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">randomNumber</span><span style="color:#56B6C2"> >=</span><span style="color:#D19A66"> 256</span><span style="color:#56B6C2"> -</span><span style="color:#ABB2BF"> (</span><span style="color:#D19A66">256</span><span style="color:#56B6C2"> %</span><span style="color:#E5C07B"> characters</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">length</span><span style="color:#ABB2BF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E06C75"> characters</span><span style="color:#ABB2BF">[</span><span style="color:#E06C75">randomNumber</span><span style="color:#56B6C2"> %</span><span style="color:#E5C07B"> characters</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">length</span><span style="color:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre><!----><!----><h2>Generate Passwords with <code>pagecrypt</code> in Your Next Project</h2><p>This post is based on what I learned while creating the <a href="https://github.com/greenheart/pagecrypt" class="link"><!---->pagecrypt<!----></a><!----> package which implements the code from this blog post, along with other related Web Crypto utilities. Since pagecrypt is just a standard ES module, it works with any JavaScript framework both on the frontend and the backend.</p><p>Install it with</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">npm</span><span style="color:#98C379"> i</span><span style="color:#98C379"> pagecrypt</span></span>
<span class="line"></span></code></pre><!----><!----><p>Then, you can generate random passwords both in <a href="https://caniuse.com/cryptography" class="link"><!---->browsers newer than 2018<!----></a><!----> and Node.js newer than v15.</p><!----><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> { </span><span style="color:#E06C75">generatePassword</span><span style="color:#ABB2BF"> } </span><span style="color:#C678DD">from</span><span style="color:#98C379"> 'pagecrypt/core'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> password</span><span style="color:#56B6C2"> =</span><span style="color:#61AFEF"> generatePassword</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">64</span><span style="color:#ABB2BF">)</span></span>
<span class="line"></span></code></pre><!----><!----><p><strong>Enjoy!</strong></p><p>Let me know if you have any suggestions and further improvements!</p></article><!----></article> <section class="dark:bg-carbon-black mx-auto mt-12 max-w-lg space-y-4 rounded-md bg-white p-4 text-center shadow-lg lg:text-lg"><h2 class="xs:text-2xl text-xl leading-none font-black tracking-tight md:text-3xl">Thank you for reading!</h2> <p><a href="https://fosstodon.org/@Greenheart" class="link compact"><!---->Let me know<!----></a><!----> if you have any questions
        or comments.</p> <p><span class="inline-flex flex-wrap items-center justify-center gap-1"><a href="/subscribe" class="link inline-flex items-center gap-1 compact"><img src="/images/feed.svg" alt="RSS/Atom feed icon" class="size-5"/>Subscribe<!----></a><!----> with your feed reader: <span class="inline-flex flex-nowrap items-center gap-0.5"><a href="/feed.atom" class="link self-center compact"><!---->Atom<!----></a><!---->/<a href="/feed.json" class="link self-center compact"><!---->JSON<!----></a><!----></span></span></p><!----> <p><a href="/blog" class="link compact"><!---->Read 15 more posts<!----></a><!----> or <a href="/" class="link compact"><!---->learn more<!----></a><!----> about me.</p></section> <nav class="mx-auto grid max-w-5xl gap-8 pt-8 sm:grid-cols-2 sm:gap-4 lg:gap-8"><!--[--><a href="/blog/nodejs-rename-file-extensions" class="dark:bg-carbon-black group flex flex-col gap-4 rounded-md bg-white p-4 shadow-md transition-all duration-300 hover:shadow-xl"><span class="flex items-center gap-2 text-xs font-bold tracking-wide uppercase"><svg viewBox="0 0 24 24" width="1.2em" height="1.2em" class="size-5 shrink-0"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 18l-6-6l6-6"></path></svg><!----> Previous</span> <span class="group-hover:decoration-moss underline-offset-3 group-hover:underline">Rename File Extensions with Node.js</span></a><!--]--> <!--[--><a href="/blog/automatic-internal-external-links-in-sveltekit" class="dark:bg-carbon-black group flex flex-col items-end gap-4 rounded-md bg-white p-4 text-end shadow-md transition-all duration-300 hover:shadow-xl"><span class="flex items-center gap-2 text-xs font-bold tracking-wide uppercase">Next <svg viewBox="0 0 24 24" width="1.2em" height="1.2em" class="size-5 shrink-0"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 18l6-6l-6-6"></path></svg><!----></span> <span class="group-hover:decoration-moss underline-offset-3 group-hover:underline">Automatic Internal and External Links in SvelteKit</span></a><!--]--></nav><!----><!----><!----></div> <footer class="container mx-auto max-w-6xl px-4 pb-8 text-center"><hr class="border-yellow mx-auto my-16 max-w-sm"/> <h2 class="xs:text-2xl mb-6 text-xl leading-none font-black tracking-tight text-balance sm:text-3xl lg:text-4xl">Let's co-create a sustainable future!</h2> <a href="#" class="bg-moss inline-flex transform-gpu justify-center justify-self-center rounded-md px-8 py-3 font-black text-black shadow-lg duration-150 ease-out hover:scale-105 hover:shadow-xl "><span class="whitespace-nowrap">Email me</span></a><!----> <p class="mt-8">© 2015 - 2026 Samuel Plumppu</p> <div class="flex flex-wrap items-center justify-center space-x-8 dark:invert my-8"><a href="https://matrix.to/#/@Greenheart:matrix.org" target="_blank" rel="noopener noreferrer" aria-label="Message me securely with the Matrix protocol"><img src="/images/matrix-logo.svg" alt="Matrix.org logo" class="h-6"/></a> <a href="https://github.com/Greenheart" target="_blank" rel="noopener noreferrer" aria-label="See my libre software at GitHub"><img src="/images/github.svg" alt="GitHub" class="aspect-square h-6"/></a> <a href="https://fosstodon.org/@Greenheart" target="_blank" rel="me noopener noreferrer" aria-label="Follow me on Mastodon"><img src="/images/mastodon-logo.svg" alt="Mastodon" class="aspect-square h-6"/></a> <a href="https://linkedin.com/in/samuelplumppu" target="_blank" rel="noopener noreferrer" aria-label="Connect with me on LinkedIn"><img src="/images/linkedin.svg" alt="LinkedIn" class="aspect-square h-6"/></a></div><!----> <p><span class="inline-flex flex-wrap items-center justify-center gap-1"><a href="/subscribe" class="link inline-flex items-center gap-1 compact"><img src="/images/feed.svg" alt="RSS/Atom feed icon" class="size-5"/>Subscribe<!----></a><!----> with your feed reader: <span class="inline-flex flex-nowrap items-center gap-0.5"><a href="/feed.atom" class="link self-center compact"><!---->Atom<!----></a><!---->/<a href="/feed.json" class="link self-center compact"><!---->JSON<!----></a><!----></span></span></p><!----></footer><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1up52ig = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.HC0HjJFi.js"),
						import("../_app/immutable/entry/app.CEKS7GuO.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
    </body>
</html>
