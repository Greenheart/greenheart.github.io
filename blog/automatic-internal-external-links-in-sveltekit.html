<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/images/favicon.svg" type="image/svg+xml" />
    <link rel="icon" href="/images/favicon-32x32.png" type="image/png" />
    <link rel="icon" href="/images/favicon.ico" />
    <meta name="theme-color" content="#5ac75f" />
    <link rel="apple-touch-icon" sizes="32x32" href="/images/favicon-32x32.png" />
    <link rel="apple-touch-icon" sizes="48x48" href="/images/compass-icon-square.svg" />
    <link rel="apple-touch-icon" sizes="72x72" href="/images/compass-icon-square.svg" />
    <link rel="apple-touch-icon" sizes="96x96" href="/images/compass-icon-square.svg" />
    <link rel="apple-touch-icon" sizes="144x144" href="/images/compass-icon-square.svg" />
    <link rel="apple-touch-icon" sizes="192x192" href="/images/compass-icon-square.svg" />
    <link rel="apple-touch-icon" sizes="256x256" href="/images/compass-icon-square.svg" />
    <link rel="apple-touch-icon" sizes="384x384" href="/images/compass-icon-square.svg" />
    <link rel="apple-touch-icon" sizes="512x512" href="/images/compass-icon-square.svg" />
    <link rel="manifest" href="/manifest.json" crossorigin="anonymous" />
    <meta http-equiv="content-security-policy" content="">
		<link href="../_app/immutable/assets/0.17523473.css" rel="stylesheet">
		<link href="../_app/immutable/assets/_post.541d5f4f.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.e874ef6e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.21b00dcf.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons.449556af.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.5f945427.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.3178882d.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/constants.94f7c113.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Link.c3d01ee6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/utils.0976737d.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/5.da9a0be7.js"><title>Automatic Internal and External Links in SvelteKit | Samuel Plumppu | Sustainability Entrepreneur &amp; Fullstack Developer</title><!-- HEAD_svelte-ffrimp_START --><!-- HEAD_svelte-ffrimp_END --><!-- HEAD_svelte-1k0szz9_START --><!-- HEAD_svelte-1k0szz9_END -->
</head>

<body class="bg-honeydew" data-sveltekit-preload-data="hover">
    <div id="svelte" style="display: contents">





    <header class="flex flex-1 justify-between p-4 max-w-6xl mx-auto flex-wrap gap-y-4 gap-x-2"><a href="/" class="link">Samuel Plumppu</a>
        <nav class="flex space-x-2 xs:space-x-4"><a href="/blog" class="link">Blog</a><a href="/about" class="link">About</a><a href="/talks" class="link">Talks</a></nav></header>

    <div class="container mx-auto max-w-6xl p-4 pb-0"><article>





<h1 class="font-black text-4xl lg:text-5xl mx-auto text-center">Automatic Internal and External Links in SvelteKit</h1>

<article class="prose lg:prose-lg xl:prose-xl 2xl:prose-2xl mx-auto text-base mt-4"><time datetime="2021-07-31T00:00:00.000Z">31 July 2021</time>
    <div class="flex flex-wrap items-center gap-2 my-2"><span class="p-1 bg-mantis text-xs md:text-sm rounded-sm leading-3">TypeScript
        </span><span class="p-1 bg-mantis text-xs md:text-sm rounded-sm leading-3">Svelte
        </span><span class="p-1 bg-mantis text-xs md:text-sm rounded-sm leading-3">SvelteKit
        </span><span class="p-1 bg-mantis text-xs md:text-sm rounded-sm leading-3">Code Snippet
        </span></div>
    <p><strong>Update 2023-03-23:</strong> This method is heavily outdated. See <a href="https://kit.svelte.dev/docs/link-options" rel="nofollow" class="link">https://kit.svelte.dev/docs/link-options</a> for modern options.</p>
<p>Markdown content on blogs often require you to support both internal and external links at the same time. Most of the times, you need separate behaviors for the different kinds, like for example prefetching internal links to improve page load times on your blog, while simultaneously opening external links in separate tabs without prefetching but instead with other attributes like <code>rel=&quot;noopener noreferrer&quot;</code>.</p>
<p>Fortunately, Svelte and SvelteKit provides a good solution to this problem.</p>
<p>First of all, we need to test if a given URL is external. This can be solved with a helper function like this:</p>
<pre class="language-ts"><!-- HTML_TAG_START --><code class="language-ts"><span class="token comment">/**
 * Test if an URL is external.
 *
 * @param href &#123;string&#125; The URL to test.
 * @returns True if the link is external, and false otherwise.
 */</span>
<span class="token keyword">function</span> <span class="token function">isExternalURL</span><span class="token punctuation">(</span>href<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
    a<span class="token punctuation">.</span>href <span class="token operator">=</span> href
    <span class="token keyword">return</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>host <span class="token operator">!==</span> a<span class="token punctuation">.</span>host
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>Then you can use <code>isExternalURL()</code> to create a Svelte <code>&lt;Link /&gt;</code> component that automatically handles the right attributes for both internal and external links. And with SvelteKitâ€™s <code>sveltekit:prefetch</code> directive, your users will get a really smooth experience browsing your website, without compromising on how you handle external links.</p>
<h2>Finished SvelteKit <code>&lt;Link /&gt;</code> Component</h2>
<pre class="language-svelte"><!-- HTML_TAG_START --><code class="language-svelte"><span class="token comment">&lt;!-- Link.svelte --></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span> <span class="token attr-name">context</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> <span class="token punctuation">&#123;</span> onMount <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'svelte'</span>

    <span class="token comment">/**
     * Test if an URL is external.
     *
     * @param href &#123;string&#125; The URL to test.
     * @returns True if the link is external, and false otherwise.
     */</span>
    <span class="token keyword">function</span> <span class="token function">isExternalURL</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">href</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean <span class="token punctuation">&#123;</span>
        <span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        a<span class="token punctuation">.</span>href <span class="token operator">=</span> href
        <span class="token keyword">return</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>host <span class="token operator">!==</span> a<span class="token punctuation">.</span>host
    <span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">let</span> href <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">let</span> <span class="token literal-property property">additionalProps</span><span class="token operator">:</span> object
    <span class="token keyword">const</span> classes <span class="token operator">=</span> <span class="token punctuation">[</span>$$props<span class="token punctuation">.</span>class <span class="token operator">??</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">onMount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isExternalURL</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            additionalProps <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">rel</span><span class="token operator">:</span> <span class="token string">'noopener noreferrer'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'_blank'</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            additionalProps <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token string-property property">'sveltekit:prefetch'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token language-javascript"><span class="token punctuation">&#123;</span>href<span class="token punctuation">&#125;</span></span> <span class="token attr-name">class=</span><span class="token language-javascript"><span class="token punctuation">&#123;</span>classes<span class="token punctuation">&#125;</span></span> <span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">...</span>$$props<span class="token punctuation">&#125;</span></span> <span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">...</span>additionalProps<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre>
<h2>Some Thoughts About This Implementation</h2>
<ol><li>It uses two separate script contexts: One with <code>context=&quot;module&quot;</code> in order to only import external dependencies and create functions once during the runtime, and the other one for the component context which handles component instances and re-renders.</li>
<li><code>$$props.class</code> is an unfortunate workaround to support external classes passed down via the regular class attribute, since <code>class</code> is a reserved keyword in JavaScript. Let me know if you have a better solution for this!</li></ol></article>

<section class="p-4 bg-white shadow-lg rounded-md mx-auto mt-12 max-w-md text-center"><h2 class="text-xl xs:text-2xl md:text-3xl leading-none font-black tracking-tight mb-4">Thank you for reading! ðŸŒ±
    </h2>
    <p class="lg:text-lg"><a href="/blog" compact class="link compact">Read more posts</a>
        or <a href="/" compact class="link compact">learn more</a> about me.
    </p></section>



</article></div>

    <footer class="container px-4 pb-4 text-center max-w-6xl mx-auto font-light"><hr class="my-16 max-w-sm mx-auto border-ming" id="contact">
    <h2 class="text-xl xs:text-2xl sm:text-3xl lg:text-4xl font-black tracking-tight leading-none mb-6">Let&#39;s co-create a sustainable future!
    </h2>

    
    

    

    
    <a href="#" class="bg-mantis py-3 px-8 inline-flex rounded-md shadow-lg hover:shadow-xl transform-gpu hover:scale-105 duration-150 justify-self-center text-black font-black justify-center"><span class="whitespace-nowrap">Show Email</span></a>

    <p class="mt-8">Â© 2015 - 2023 Samuel Plumppu</p>

    <div class="flex justify-center space-x-8 items-center my-8 flex-wrap"><a href="https://matrix.to/#/@Greenheart:matrix.org" target="_blank" rel="noopener noreferrer" aria-label="Message me securely with the Matrix protocol"><img src="/images/matrix-logo.svg" alt="Matrix.org logo" class="h-8"></a>
        <a href="https://github.com/Greenheart" target="_blank" rel="noopener noreferrer" aria-label="See my free software at GitHub"><img src="/images/github.svg" alt="GitHub" class="w-8 h-8"></a>
        <a href="https://fosstodon.org/@Greenheart" target="_blank" rel="me noopener noreferrer" aria-label="Follow me on Mastodon"><img src="/images/mastodon-logo.svg" alt="Mastodon" class="w-8 h-8"></a>
        <a href="https://linkedin.com/in/samuelplumppu" target="_blank" rel="noopener noreferrer" aria-label="Connect with me on LinkedIn"><img src="/images/linkedin.svg" alt="LinkedIn" class="w-8 h-8"></a></div></footer>

    <style lang="postcss">@media (max-width:360px){header{justify-content:center!important}}</style>


			
			<script>
				{
					__sveltekit_150le6p = {
						base: new URL("..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [{"type":"data","data":null,"uses":{},"slash":"ignore"},null];

					Promise.all([
						import("../_app/immutable/entry/start.e874ef6e.js"),
						import("../_app/immutable/entry/app.5f945427.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
</body>

</html>